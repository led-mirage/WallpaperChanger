# WallpaperChanger 仕様書

© 2025 led-mirage

## 🔖 プログラム概要

### プログラム名

**WallpaperChanger.exe**

### 機能

指定されたフォルダから画像をランダムに１枚選択し、明るさ補正を行ったうえで Windows の壁紙に設定する

### 動作環境

- Windows 11
- Python 3.11以上（開発時は3.13.9で検証）

### 処理フロー

1. 設定ファイルまたは起動引数から設定値を読み込む
2. 指定フォルダ内の画像を検索し、ランダムに１枚を選択
3. 選択した画像に明るさ補正をかけ、Windowsのテンポラリフォルダに保存
4. 保存したファイルをWindowsの壁紙に設定

### 対応画像

以下の拡張子のファイルを検索する。

".jpg", ".jpeg", ".png", ".bmp", ".webp"

### 特記事項

- サブフォルダも検索する
- 明るさ補正を行う際、元の画像は変更しない
- 壁紙の配置方法はOSの設定に任せる

## 🔖 コマンドライン

### 設定ファイルを指定する方法

```
WallpaperChanger.exe <config.yaml>
```

### 引数にパラメータを指定する方法

```
WallpaperChanger.exe
    --dir <path> [--dir <path> ...]
    --brightness <value>
    --temp <filename>
    --version
```

### オプション

| 項目 | 説明 | デフォルト値 |
|-|-|-|
| <config.yaml> | 設定ファイルのパス | |
| --dir | 画像フォルダを指定（複数可） | |
| --brightness | 明るさ補正値（0.0～2.0）| 1.0 |
| --temp | TEMP に保存するファイル名 | wallpaper_temp.png |
| --version | バージョン情報を表示 | |

### 特記事項

- --versionがあったら情報を表示して即終了
- <config.yaml>優先（他のパラメータは無視）

## 🔖 設定ファイル

- ファイル名: config.yaml（任意）
- ファイル形式: YAML
- 設定項目
    - image_dirs: list[str]
        - 画像を検索するフォルダ
    - brightness: float
        - 明るさ補正値（0.0～2.0）
        - 0.8は原画の80%の明るさ
    - temp_filename: str
        - テンポラリファイル名
        - png形式推奨

【設定例】

```yaml
image_dirs:
  - 'C:\Users\UserA\Desktop\Wallpapers'
brightness: 0.8
temp_filename: 'wallpaper_temp.png'
```

## 🔖 終了コード

- 0: 正常終了
- 1: 起動引数の間違い
- 2: 実行時エラー

## 🔖 エラーログ

実行時エラーが発生した場合 `error.log` が生成される。
ファイルが既にある場合は末尾に追記される。

ファイル生成場所は `config.yaml` と同じフォルダ。  
設定ファイルを使用しない場合は、`WallpaperChanger.exe` と同じフォルダに生成される。

サンプル：

```log
[2025-12-08 21:36:56] Error: 'No images available to pick.'
```
